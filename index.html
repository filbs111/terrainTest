<html>

<head>

<title>WebGL Terrain Test</title>

<link rel='stylesheet' type='text/css' media='screen' href='main.css'>

<script id="shader-simple-vs" type="x-shader/x-vertex">

	attribute vec3 aVertexPosition;
	attribute vec2 aVertexGradient;
	//attribute vec3 aVertexNormal;
	uniform mat4 uMVMatrix;
	uniform mat4 uPMatrix;
	uniform vec2 uCentrePos;
	varying vec3 vColor;
	
	void main(void) {
		vec4 transformedCoord = uMVMatrix * vec4(aVertexPosition,1.0);	//todo use 4x3 mat?
		gl_Position = uPMatrix * transformedCoord;	
		
		//vColor= vec3(1.0,0.0,0.0);
		//vColor= aVertexPosition;
		
		float scale = 0.0625;
		vec2 modvec = mod(aVertexPosition.xy , scale) - vec2(0.5*scale);
		float lensq = dot(modvec, modvec);
		float stepped = step(0.0004, lensq);
		float distFromCentre = length(aVertexPosition.xy - uCentrePos);
		float ringSize = 0.05;
		//vColor= stepped * vec3(0.5+50.0*aVertexGradient.x, 0.5+50.0*aVertexGradient.y, mod(distFromCentre,0.05));
		vColor= vec3(0.5+50.0*aVertexGradient.x, 0.5+50.0*aVertexGradient.y, mod(distFromCentre,ringSize)/ringSize);

		//vColor= vec3(0.5+20.0*aVertexGradient.x);
	}
</script>

<script id="shader-simple-fs" type="x-shader/x-fragment">
	precision mediump float;
	varying vec3 vColor;

	void main(void){
		//gl_FragColor=vec4(vec3(10.0*vColor.z + 0.1),1.0);
		gl_FragColor=vec4(vColor, 1.0);
	}
</script>


</head>
<body>


<div id="container">
	<canvas class="canvas" id="mycanvas"></canvas>
	<canvas class="canvas" id="mycanvasoverlay"></canvas>
</div>
<div id="container2">
	<canvas id="myglcanvas"></canvas>
</div>

<div><p>downscale?</p><input type="checkbox" id="downscale"></div>

<!--only relevant if downscale is checked, default (0) should be same as if downscale not checked-->
<div><input type="range" min="0" max="5" step="1" value="0" id="scaleslider"></div>

<script type="text/javascript" src="lib/stats.min.js"></script>
<script type="text/javascript" src="utils/optional_stats.js"></script>
<script type="text/javascript" src="lib/gl-matrix-min.js"></script>
<script type="text/javascript" src="utils/webgl_utils.js"></script>
<script type="text/javascript" src="utils/terrain_utils.js"></script>
<script type="text/javascript" src="utils/quadtree_util.js"></script>
<script type="text/javascript" src="js/main.js"></script>

</html>